{"dependencies":[{"name":"expo-constants","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":39,"index":39}}],"key":"pPv5KzfRT0rL6NCr7G9k0o4d1W8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"generateMonthlyReflection\", {\n    enumerable: true,\n    get: function () {\n      return generateMonthlyReflection;\n    }\n  });\n  var _expoConstants = require(_dependencyMap[0], \"expo-constants\");\n  var Constants = _interopDefault(_expoConstants);\n  // Get Gemini API key from expo-constants (safe for client-side use)\n  const GEMINI_API_KEY = Constants.default.expoConfig?.extra?.EXPO_PUBLIC_GEMINI_API_KEY;\n  if (!GEMINI_API_KEY) {\n    console.warn('EXPO_PUBLIC_GEMINI_API_KEY not found in app.json. Monthly Reflection will not work.');\n  }\n  const GEMINI_API_URL = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent';\n  /**\n   * Generate monthly reflection using Google Gemini API\n   * This calls the Gemini REST API directly from the client\n   */\n  const generateMonthlyReflection = async request => {\n    if (!GEMINI_API_KEY) {\n      throw new Error('Gemini API key is not configured. Please add EXPO_PUBLIC_GEMINI_API_KEY to app.json');\n    }\n    try {\n      console.log('Calling Gemini API for monthly reflection...');\n      console.log('Request entries count:', request.entries.length);\n\n      // Create prompt for Gemini\n      const prompt = `You are a neutral reflection assistant for a daily journaling app called OneThing.\n\nYour role is to:\n- Detect recurring themes and patterns in the user's journal entries\n- Summarize emotional patterns neutrally\n- Reflect language back to the user\n\nYou MUST NOT:\n- Give advice or recommendations\n- Diagnose mental health conditions\n- Use motivational or therapeutic language\n- Suggest actions or changes\n- Make judgments or evaluations\n- Use emojis\n\nTone: Neutral, descriptive, reflective, non-judgmental.\nLength: 3-5 sentences maximum.\n\nExample style:\n\"This month, your answers often referenced tiredness around work and moments of relief during quieter days. Several entries reflected a desire for fewer obligations. This summary simply reflects recurring themes without judgment.\"\n\nHere are the journal entries to analyze:\n\n${request.entries.join('\\n\\n---\\n\\n')}\n\nPlease provide a brief, neutral summary of recurring themes and patterns.`;\n\n      // Call Gemini API\n      const response = await fetch(`${GEMINI_API_URL}?key=${GEMINI_API_KEY}`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          contents: [{\n            parts: [{\n              text: prompt\n            }]\n          }],\n          generationConfig: {\n            temperature: 0.7,\n            maxOutputTokens: 500\n          }\n        })\n      });\n      if (!response.ok) {\n        const errorText = await response.text();\n        console.error('Gemini API Error Response:', errorText);\n        throw new Error(`Gemini API error: ${response.status} ${response.statusText}`);\n      }\n      const result = await response.json();\n      console.log('Monthly reflection generated successfully');\n\n      // Extract text from Gemini response\n      const summary = result.candidates?.[0]?.content?.parts?.[0]?.text || 'Unable to generate summary';\n      return {\n        summary\n      };\n    } catch (error) {\n      console.error('Error generating monthly reflection:', error);\n      throw error;\n    }\n  };\n});","lineCount":102,"map":[[12,2,24,0,"Object"],[12,8,24,0],[12,9,24,0,"defineProperty"],[12,23,24,0],[12,24,24,0,"exports"],[12,31,24,0],[13,4,24,0,"enumerable"],[13,14,24,0],[14,4,24,0,"get"],[14,7,24,0],[14,18,24,0,"get"],[14,19,24,0],[15,6,24,0],[15,13,24,0,"generateMonthlyReflection"],[15,38,24,0],[16,4,24,0],[17,2,24,0],[18,2,1,0],[18,6,1,0,"_expoConstants"],[18,20,1,0],[18,23,1,0,"require"],[18,30,1,0],[18,31,1,0,"_dependencyMap"],[18,45,1,0],[19,2,1,0],[19,6,1,0,"Constants"],[19,15,1,0],[19,18,1,0,"_interopDefault"],[19,33,1,0],[19,34,1,0,"_expoConstants"],[19,48,1,0],[20,2,3,0],[21,2,4,0],[21,8,4,6,"GEMINI_API_KEY"],[21,22,4,20],[21,25,4,23,"Constants"],[21,34,4,32],[21,35,4,32,"default"],[21,42,4,32],[21,43,4,33,"expoConfig"],[21,53,4,43],[21,55,4,45,"extra"],[21,60,4,50],[21,62,4,52,"EXPO_PUBLIC_GEMINI_API_KEY"],[21,88,4,78],[22,2,6,0],[22,6,6,4],[22,7,6,5,"GEMINI_API_KEY"],[22,21,6,19],[22,23,6,21],[23,4,7,2,"console"],[23,11,7,9],[23,12,7,10,"warn"],[23,16,7,14],[23,17,7,15],[23,102,7,100],[23,103,7,101],[24,2,8,0],[25,2,10,0],[25,8,10,6,"GEMINI_API_URL"],[25,22,10,20],[25,25,10,23],[25,115,10,113],[26,2,20,0],[27,0,21,0],[28,0,22,0],[29,0,23,0],[30,2,24,7],[30,8,24,13,"generateMonthlyReflection"],[30,33,24,38],[30,36,24,41],[30,42,25,2,"request"],[30,49,25,35],[30,53,26,41],[31,4,27,2],[31,8,27,6],[31,9,27,7,"GEMINI_API_KEY"],[31,23,27,21],[31,25,27,23],[32,6,28,4],[32,12,28,10],[32,16,28,14,"Error"],[32,21,28,19],[32,22,28,20],[32,107,28,105],[32,108,28,106],[33,4,29,2],[34,4,31,2],[34,8,31,6],[35,6,32,4,"console"],[35,13,32,11],[35,14,32,12,"log"],[35,17,32,15],[35,18,32,16],[35,64,32,62],[35,65,32,63],[36,6,33,4,"console"],[36,13,33,11],[36,14,33,12,"log"],[36,17,33,15],[36,18,33,16],[36,42,33,40],[36,44,33,42,"request"],[36,51,33,49],[36,52,33,50,"entries"],[36,59,33,57],[36,60,33,58,"length"],[36,66,33,64],[36,67,33,65],[38,6,35,4],[39,6,36,4],[39,12,36,10,"prompt"],[39,18,36,16],[39,21,36,19],[40,0,37,0],[41,0,38,0],[42,0,39,0],[43,0,40,0],[44,0,41,0],[45,0,42,0],[46,0,43,0],[47,0,44,0],[48,0,45,0],[49,0,46,0],[50,0,47,0],[51,0,48,0],[52,0,49,0],[53,0,50,0],[54,0,51,0],[55,0,52,0],[56,0,53,0],[57,0,54,0],[58,0,55,0],[59,0,56,0],[60,0,57,0],[61,0,58,0],[62,0,59,0],[62,2,59,2,"request"],[62,9,59,9],[62,10,59,10,"entries"],[62,17,59,17],[62,18,59,18,"join"],[62,22,59,22],[62,23,59,23],[62,36,59,36],[62,37,59,37],[63,0,60,0],[64,0,61,0],[64,74,61,74],[66,6,63,4],[67,6,64,4],[67,12,64,10,"response"],[67,20,64,18],[67,23,64,21],[67,29,64,27,"fetch"],[67,34,64,32],[67,35,64,33],[67,38,64,36,"GEMINI_API_URL"],[67,52,64,50],[67,60,64,58,"GEMINI_API_KEY"],[67,74,64,72],[67,76,64,74],[67,78,64,76],[68,8,65,6,"method"],[68,14,65,12],[68,16,65,14],[68,22,65,20],[69,8,66,6,"headers"],[69,15,66,13],[69,17,66,15],[70,10,67,8],[70,24,67,22],[70,26,67,24],[71,8,68,6],[71,9,68,7],[72,8,69,6,"body"],[72,12,69,10],[72,14,69,12,"JSON"],[72,18,69,16],[72,19,69,17,"stringify"],[72,28,69,26],[72,29,69,27],[73,10,70,8,"contents"],[73,18,70,16],[73,20,70,18],[73,21,71,10],[74,12,72,12,"parts"],[74,17,72,17],[74,19,72,19],[74,20,73,14],[75,14,74,16,"text"],[75,18,74,20],[75,20,74,22,"prompt"],[76,12,75,14],[76,13,75,15],[77,10,77,10],[77,11,77,11],[77,12,78,9],[78,10,79,8,"generationConfig"],[78,26,79,24],[78,28,79,26],[79,12,80,10,"temperature"],[79,23,80,21],[79,25,80,23],[79,28,80,26],[80,12,81,10,"maxOutputTokens"],[80,27,81,25],[80,29,81,27],[81,10,82,8],[82,8,83,6],[82,9,83,7],[83,6,84,4],[83,7,84,5],[83,8,84,6],[84,6,86,4],[84,10,86,8],[84,11,86,9,"response"],[84,19,86,17],[84,20,86,18,"ok"],[84,22,86,20],[84,24,86,22],[85,8,87,6],[85,14,87,12,"errorText"],[85,23,87,21],[85,26,87,24],[85,32,87,30,"response"],[85,40,87,38],[85,41,87,39,"text"],[85,45,87,43],[85,46,87,44],[85,47,87,45],[86,8,88,6,"console"],[86,15,88,13],[86,16,88,14,"error"],[86,21,88,19],[86,22,88,20],[86,50,88,48],[86,52,88,50,"errorText"],[86,61,88,59],[86,62,88,60],[87,8,89,6],[87,14,89,12],[87,18,89,16,"Error"],[87,23,89,21],[87,24,89,22],[87,45,89,43,"response"],[87,53,89,51],[87,54,89,52,"status"],[87,60,89,58],[87,64,89,62,"response"],[87,72,89,70],[87,73,89,71,"statusText"],[87,83,89,81],[87,85,89,83],[87,86,89,84],[88,6,90,4],[89,6,92,4],[89,12,92,10,"result"],[89,18,92,16],[89,21,92,19],[89,27,92,25,"response"],[89,35,92,33],[89,36,92,34,"json"],[89,40,92,38],[89,41,92,39],[89,42,92,40],[90,6,93,4,"console"],[90,13,93,11],[90,14,93,12,"log"],[90,17,93,15],[90,18,93,16],[90,61,93,59],[90,62,93,60],[92,6,95,4],[93,6,96,4],[93,12,96,10,"summary"],[93,19,96,17],[93,22,96,20,"result"],[93,28,96,26],[93,29,96,27,"candidates"],[93,39,96,37],[93,42,96,40],[93,43,96,41],[93,44,96,42],[93,46,96,44,"content"],[93,53,96,51],[93,55,96,53,"parts"],[93,60,96,58],[93,63,96,61],[93,64,96,62],[93,65,96,63],[93,67,96,65,"text"],[93,71,96,69],[93,75,96,73],[93,103,96,101],[94,6,98,4],[94,13,98,11],[95,8,98,13,"summary"],[96,6,98,21],[96,7,98,22],[97,4,99,2],[97,5,99,3],[97,6,99,4],[97,13,99,11,"error"],[97,18,99,16],[97,20,99,18],[98,6,100,4,"console"],[98,13,100,11],[98,14,100,12,"error"],[98,19,100,17],[98,20,100,18],[98,58,100,56],[98,60,100,58,"error"],[98,65,100,63],[98,66,100,64],[99,6,101,4],[99,12,101,10,"error"],[99,17,101,15],[100,4,102,2],[101,2,103,0],[101,3,103,1],[102,0,103,2],[102,3]],"functionMap":{"names":["<global>","generateMonthlyReflection"],"mappings":"AAA;yCCuB;CD+E"},"hasCjsExports":false},"type":"js/module"}]}